# Введение в криптографию для начинающих в CTF

## Что такое криптография в CTF?

Криптография — это наука о методах защиты информации путем преобразования ее в форму, непонятную без специального знания, обычно называемого ключом. В контексте CTF (Capture the Flag) соревнований, криптографические задания требуют от участников применения знаний и навыков для расшифровки или анализа зашифрованных данных с целью получения флага.

## Основные концепции

### Шифрование и дешифрование

- **Шифрование** — процесс преобразования открытого текста (понятного сообщения) в зашифрованный текст с использованием алгоритма и ключа.
- **Дешифрование** — обратный процесс, преобразование зашифрованного текста обратно в открытый текст с помощью ключа.

**Пример:**

Если мы используем простой шифр Цезаря с сдвигом на 3, то слово "HELLO" преобразуется в "KHOOR".

### Симметричные и асимметричные алгоритмы

- **Симметричные алгоритмы** используют один и тот же ключ для шифрования и дешифрования.

  **Пример:**

  Алгоритм AES (Advanced Encryption Standard) использует один секретный ключ для шифрования и дешифрования данных.

- **Асимметричные алгоритмы** используют пару ключей: открытый ключ для шифрования и закрытый ключ для дешифрования.

  **Пример:**

  В RSA открытый ключ используется для шифрования сообщения, а соответствующий закрытый ключ — для его дешифрования.

## Типы задач в криптографии CTF

### Классические шифры

#### Шифр Цезаря

**Описание:**

Шифр Цезаря — это простой моноалфавитный шифр, где каждая буква в тексте заменяется на букву, находящуюся на фиксированном количестве позиций дальше по алфавиту.

**Пример:**

Сдвиг на 2:

- Открытый текст: "ATTACK AT DAWN"
- Шифротекст: "CVVCEM CV FCYP"

**Как решить:**

Если известно или подозревается использование шифра Цезаря, можно попробовать все возможные сдвиги (их всего 25 для английского алфавита) и посмотреть, какой из них дает осмысленный текст.

#### Шифр Виженера

**Описание:**

Шифр Виженера использует ключевое слово для шифрования, применяя серию шифров Цезаря с разными сдвигами.

**Пример:**

- Открытый текст: "HELLO WORLD"
- Ключевое слово: "KEY"
- Шифротекст: "RIJVS UYVJN"

**Как решить:**

Часто можно использовать анализ частот или известные методы для взлома шифра Виженера, особенно если известна длина ключа.

#### Шифр Плейфера

**Описание:**

Шифр Плейфера шифрует пары букв (диграммы) с использованием матрицы 5x5, построенной на основе ключевого слова.

**Пример:**

- Ключевое слово: "MONARCHY"
- Матрица:

  ```
  M O N A R
  C H Y B D
  E F G I/J K
  L P Q S T
  U V W X Z
  ```

- Открытый текст: "HELLO WORLD"
- Шифротекст: "KFRP MVNRVE"

**Как решить:**

Реконструировав матрицу по ключевому слову и применив правила шифра Плейфера, можно расшифровать сообщение.

### Современные алгоритмы

#### AES (Advanced Encryption Standard)

**Описание:**

AES — симметричный блочный шифр, использующий ключи длиной 128, 192 или 256 бит.

**Пример задачи:**

- Дано: зашифрованный текст и IV (инициализационный вектор).
- Требуется: расшифровать текст, зная, что использовался режим CBC и ключ слабой сложности.

**Как решить:**

Если ключ короткий или используется слабый пароль, можно попытаться провести брутфорс-атаку или использовать известные уязвимости.

#### RSA

**Описание:**

RSA — асимметричный алгоритм шифрования, основанный на сложности факторизации произведения двух больших простых чисел.

**Пример задачи:**

- Дано: открытый ключ (n и e) и зашифрованное сообщение.
- Требуется: расшифровать сообщение.

**Как решить:**

Если простые множители числа n (p и q) малы или n было сгенерировано неправильно, можно попытаться факторизовать n и найти закрытый ключ для дешифрования.

**Пример:**

- n = 3233 (произведение p=61 и q=53)
- e = 17
- Зашифрованное сообщение: c = 855

Решение:

1. Вычисляем φ(n) = (p - 1)(q - 1) = 3120
2. Находим d, такое что (d * e) mod φ(n) = 1; d = 2753
3. Дешифруем сообщение: m = c^d mod n = 855^2753 mod 3233 = 123

### Стеганография

**Описание:**

Стеганография — это метод скрытия информации внутри других файлов или сообщений.

**Пример задачи:**

- Дано: изображение, которое на первый взгляд не содержит ничего необычного.
- Требуется: найти скрытый флаг.

**Как решить:**

- **LSB-анализ**: проверить на наличие данных в наименее значащих битах пикселей.
- **Метаданные**: исследовать EXIF-данные изображения.
- **Инструменты**: использовать программы вроде `stegsolve` или `zsteg`.

### Криптоанализ

#### Анализ частот

**Описание:**

Используется для взлома моноалфавитных шифров, основываясь на частоте появления букв в языке.

**Пример задачи:**

- Дано: зашифрованный текст.
- Требуется: расшифровать его.

**Как решить:**

1. Посчитать частоту каждой буквы в шифротексте.
2. Сравнить с известной частотой букв в языке (например, в английском языке наиболее частая буква — 'E').
3. Предположить соответствия и попытаться восстановить открытый текст.

#### Атака по известному открытому тексту

**Описание:**

Атаки, где атакующий знает часть открытого текста и соответствующий шифротекст.

**Пример задачи:**

- Дано: часть открытого текста и соответствующий шифротекст.
- Требуется: найти ключ или расшифровать остальную часть сообщения.

**Как решить:**

Использовать известные соответствия для восстановления ключа или алгоритма шифрования.

## Инструменты и ресурсы

### Онлайн-инструменты

- **[CyberChef](https://gchq.github.io/CyberChef/)**: универсальный инструмент для обработки и анализа данных. Поддерживает множество операций, таких как декодирование, шифрование, преобразования форматов и многое другое.

  **Пример использования:**

  - Расшифровать Base64: вставить зашифрованный текст и выбрать операцию "From Base64".

- **[Cryptii](https://cryptii.com/)**: позволяет выполнять различные преобразования и шифрования, поддерживает множество классических шифров.

  **Пример использования:**

  - Использовать шифр Виженера: ввести открытый текст и ключ, получить шифротекст.

### Программные инструменты

- **Hashcat**: продвинутый инструмент для взлома хешей с использованием GPU.

  **Пример использования:**

  - Взломать MD5-хеш с помощью словаря: `hashcat -m 0 -a 0 hash.txt wordlist.txt`

- **John the Ripper**: утилита для взлома паролей и хешей.

  **Пример использования:**

  - Автоматическое определение типа хеша и его взлом: `john hash.txt`

- **Ghidra**: инструмент для обратной разработки, полезен для анализа бинарных файлов и понимания собственных алгоритмов шифрования в задачах.

  **Пример использования:**

  - Открыть бинарный файл, проанализировать функции, найти алгоритм шифрования.

### Учебные ресурсы

- **[Cryptopals](https://cryptopals.com/)**: набор задач для обучения криптографии, начиная от простых до продвинутых концепций.

  **Пример задачи:**

  - Реализовать функцию XOR двух буферов и использовать ее для расшифровки сообщения.

- **[CryptoHack](https://cryptohack.org/)**: платформа для изучения криптографии через интерактивные задачи и CTF-челленджи.

  **Пример задачи:**

  - Взлом шифра RSA с общим модулем n.

## Подходы к решению криптографических задач

1. **Анализ задания**

   - Внимательно прочитайте условие задачи.
   - Обратите внимание на любые подсказки или необычные детали.
   - Попытайтесь определить используемый алгоритм или метод шифрования.

   **Пример:**

   Если в задании упоминается "ключ длиной 16 символов" и "блоки по 16 байт", это может указывать на использование AES-128.

2. **Проверка метаданных**

   - Используйте инструменты для просмотра метаданных файлов (например, `exiftool` для изображений).
   - Метаданные могут содержать скрытые сообщения или ключи.

   **Пример:**

   В EXIF-данных изображения может быть указано значение, которое является паролем для расшифровки.

3. **Использование скриптов**

   - Автоматизируйте повторяющиеся задачи с помощью Python, Bash или других языков.
   - Используйте библиотеки, такие как `pycrypto` или `cryptography`.

   **Пример:**

   Написать скрипт для перебора всех возможных сдвигов в шифре Цезаря.

4. **Обратная разработка**

   - Если предоставлен бинарный файл или скрипт, используйте инструменты для анализа кода.
   - Поймите, как работает алгоритм, и воспроизведите его для расшифровки.

   **Пример:**

   В задаче предоставлен исполняемый файл, который шифрует ввод пользователя. Анализируя код, можно найти способ обратного преобразования.
